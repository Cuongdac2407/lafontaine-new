<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài Thơ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        h1 {
            text-align: center;
        }

        .poem-title {
            cursor: pointer;
            color: blue;
            text-decoration: underline;
            margin: 10px 0;
        }

        .poem-content {
            display: flex;
            justify-content: space-between;
        }

        .poem-column {
            width: 45%;
        }

        .poem-column h3 {
            text-align: center;
        }

        .poem-text {
            white-space: pre-line;
            margin: 20px;
            line-height: 1.6;
        }

        button {
            display: block;
            margin: 10px auto;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
        }

        .poem-list-container {
            display: flex;
            justify-content: space-between;
        }

        .poem-list-column {
            width: 48%;
        }

        #copy-all-fr-button {
            background-color: #2196F3;
        }

        #copy-all-vi-button {
            background-color: #009688;
        }

        #copy-fr-button {
            background-color: #FF9800;
        }

        #copy-vi-button {
            background-color: #9C27B0;
        }

        #download-all-fr-button {
            background-color: #3F51B5;
        }

        #download-all-vi-button {
            background-color: #00796B;
        }

        #download-fr-button {
            background-color: #F57C00;
        }

        #download-vi-button {
            background-color: #7B1FA2;
        }

        #back-button {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background-color: #f44336;
        }

        .copy-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
    </style>
</head>

<body>
    <h1>Bài Thơ</h1>

    <!-- Các nút copy và tải toàn bộ -->
    <div class="copy-buttons">
        <button id="copy-all-fr-button">Copy 169 Bài Thơ (Pháp)</button>
        <button id="copy-all-vi-button">Copy 169 Bài Thơ (Việt)</button>
        <button id="download-all-fr-button">Tải 169 Bài Thơ (Pháp)</button>
        <button id="download-all-vi-button">Tải 169 Bài Thơ (Việt)</button>
    </div>

    <div id="poem-list" class="poem-list-container">
        <div id="poem-list-left" class="poem-list-column"></div>
        <div id="poem-list-right" class="poem-list-column"></div>
    </div>

    <div id="poem-detail" style="display: none;">
        <button id="back-button">Quay lại danh sách</button>
        <h2 id="poem-title"></h2>

        <!-- Các nút copy và tải bài thơ hiện tại -->
        <div class="copy-buttons">
            <button id="copy-fr-button">Copy Bài Thơ (Pháp)</button>
            <button id="copy-vi-button">Copy Bài Thơ (Việt)</button>
            <button id="download-fr-button">Tải Bài Thơ (Pháp)</button>
            <button id="download-vi-button">Tải Bài Thơ (Việt)</button>
        </div>

        <div id="poem-content" class="poem-content"></div>
    </div>

    <script>
        let poemsData = [];
        let currentPoemIndex = 0;

        fetch('poems_fr.json')
            .then(response => response.json())
            .then(poems => {
                poemsData = poems;

                function displayPoemList() {
                    const leftColumn = document.getElementById('poem-list-left');
                    const rightColumn = document.getElementById('poem-list-right');
                    const total = poems.length;
                    const half = Math.ceil(total / 2);

                    for (let i = 0; i < total; i++) {
                        const poem = poems[i];
                        const poemTitle = document.createElement('h3');
                        poemTitle.classList.add('poem-title');
                        poemTitle.textContent = `${i + 1}. ${poem.title}`;
                        poemTitle.onclick = () => displayPoemDetail(i);

                        if (i < half) {
                            leftColumn.appendChild(poemTitle);
                        } else {
                            rightColumn.appendChild(poemTitle);
                        }
                    }
                }

                function formatPoem(poemText) {
                    return poemText.split('\n\n').map(stanza => `<p>${stanza}</p>`).join('');
                }

                function displayPoemDetail(index) {
                    currentPoemIndex = index;
                    const poem = poems[index];
                    document.getElementById('poem-title').textContent = poem.title;
                    const poemContentDiv = document.getElementById('poem-content');

                    const frColumn = document.createElement('div');
                    frColumn.classList.add('poem-column');
                    const frHeader = document.createElement('h3');
                    frHeader.textContent = 'Tiếng Pháp';
                    const frPoem = document.createElement('div');
                    frPoem.classList.add('poem-text');
                    frPoem.innerHTML = formatPoem(poem.poem);
                    frColumn.appendChild(frHeader);
                    frColumn.appendChild(frPoem);

                    const viColumn = document.createElement('div');
                    viColumn.classList.add('poem-column');
                    const viHeader = document.createElement('h3');
                    viHeader.textContent = 'Tiếng Việt';
                    const viPoem = document.createElement('div');
                    viPoem.classList.add('poem-text');
                    viPoem.innerHTML = formatPoem(poem['poem-vi']);
                    viColumn.appendChild(viHeader);
                    viColumn.appendChild(viPoem);

                    poemContentDiv.innerHTML = '';
                    poemContentDiv.appendChild(frColumn);
                    poemContentDiv.appendChild(viColumn);

                    document.getElementById('poem-list').style.display = 'none';
                    document.getElementById('poem-detail').style.display = 'block';
                }

                function goBack() {
                    document.getElementById('poem-list').style.display = 'flex';
                    document.getElementById('poem-detail').style.display = 'none';
                }

                // Copy bài thơ hiện tại
                document.getElementById('copy-fr-button').addEventListener('click', () => {
                    const poem = poemsData[currentPoemIndex];
                    const frText = `${poem.title}\n\n[Tiếng Pháp]\n${poem.poem}`;
                    navigator.clipboard.writeText(frText).then(() => {
                        alert('Đã copy bài thơ tiếng Pháp!');
                    });
                });

                document.getElementById('copy-vi-button').addEventListener('click', () => {
                    const poem = poemsData[currentPoemIndex];
                    const viText = `${poem.title}\n\n[Tiếng Việt]\n${poem['poem-vi']}`;
                    navigator.clipboard.writeText(viText).then(() => {
                        alert('Đã copy bài thơ tiếng Việt!');
                    });
                });

                // Copy toàn bộ
                document.getElementById('copy-all-fr-button').addEventListener('click', () => {
                    const allFrText = poemsData.map((poem, i) => {
                        return `${i + 1}. ${poem.title}\n\n[Tiếng Pháp]\n${poem.poem}\n\n---\n`;
                    }).join('');
                    navigator.clipboard.writeText(allFrText).then(() => {
                        alert('Đã copy 169 bài thơ tiếng Pháp!');
                    });
                });

                document.getElementById('copy-all-vi-button').addEventListener('click', () => {
                    const allViText = poemsData.map((poem, i) => {
                        return `${i + 1}. ${poem.title}\n\n[Tiếng Việt]\n${poem['poem-vi']}\n\n---\n`;
                    }).join('');
                    navigator.clipboard.writeText(allViText).then(() => {
                        alert('Đã copy 169 bài thơ tiếng Việt!');
                    });
                });

                // Tạo và tải file .txt
                function downloadTextFile(filename, textContent) {
                    const blob = new Blob([textContent], { type: 'text/plain' });
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(blob);
                    link.download = filename;
                    link.click();
                    URL.revokeObjectURL(link.href);
                }

                // Tải bài thơ hiện tại
                document.getElementById('download-fr-button').addEventListener('click', () => {
                    const poem = poemsData[currentPoemIndex];
                    const frText = `${poem.title}\n\n[Tiếng Pháp]\n${poem.poem}`;
                    downloadTextFile(`${poem.title}_FR.txt`, frText);
                });

                document.getElementById('download-vi-button').addEventListener('click', () => {
                    const poem = poemsData[currentPoemIndex];
                    const viText = `${poem.title}\n\n[Tiếng Việt]\n${poem['poem-vi']}`;
                    downloadTextFile(`${poem.title}_VI.txt`, viText);
                });

                // Tải toàn bộ
                document.getElementById('download-all-fr-button').addEventListener('click', () => {
                    const allFrText = poemsData.map((poem, i) => {
                        return `${i + 1}. ${poem.title}\n\n[Tiếng Pháp]\n${poem.poem}\n\n---\n`;
                    }).join('');
                    downloadTextFile(`169_Bai_Tho_Phap.txt`, allFrText);
                });

                document.getElementById('download-all-vi-button').addEventListener('click', () => {
                    const allViText = poemsData.map((poem, i) => {
                        return `${i + 1}. ${poem.title}\n\n[Tiếng Việt]\n${poem['poem-vi']}\n\n---\n`;
                    }).join('');
                    downloadTextFile(`169_Bai_Tho_Viet.txt`, allViText);
                });

                document.getElementById('back-button').addEventListener('click', goBack);

                displayPoemList();
            });
    </script>
</body>

</html>
